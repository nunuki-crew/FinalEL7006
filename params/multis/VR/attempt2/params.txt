trainloader = DataLoader(train_dataset, batch_size = 100, shuffle = True, num_workers = 2)
valloader = DataLoader(val_dataset, batch_size = 100, shuffle = False, num_workers = 2)



model = SleepStager(n_chans = 19, pretext = True)
# criterion = InfoNceLoss(tau = 0.3)
criterion = VICReg()
optimizer = torch.optim.Adam(model.parameters(), lr = 0.001)
pretext_train(model, 50, trainloader, valloader, criterion, optimizer, state = None, name = "multi_VR")
