trainloader = DataLoader(train_dataset, batch_size = 1000, shuffle = True, num_workers = 2)
valloader = DataLoader(val_dataset, batch_size = 1000, shuffle = False, num_workers = 2)
# trainloader = DataLoader(train_dataset, batch_size = 4, shuffle = True, num_workers = 0)
# valloader = DataLoader(val_dataset, batch_size = 4, shuffle = False, num_workers = 0)

model = SleepStager(n_chans = 1, pretext = True)
# criterion = InfoNceLoss(tau = 0.3)
criterion = VICReg()
optimizer = torch.optim.Adam(model.parameters(), lr = 0.001)
# dataset = torch.load("test_batch.pt")
# data = (dataset, dataset)
# pretext_train(model, 30, trainloader, valloader, criterion, optimizer, each = 2, state = "LastencoderINF_2.pt", name = "INF")
pretext_train(model, 50, trainloader, valloader, criterion, optimizer, state = 'Lastencodersingle_VR_5.pt', name = "single_VR")