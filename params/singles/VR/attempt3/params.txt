trainloader = DataLoader(train_dataset, batch_size = 1000, shuffle = True, num_workers = 2)
valloader = DataLoader(val_dataset, batch_size = 1000, shuffle = False, num_workers = 2)

model = SleepStager(n_chans = 1, pretext = True)

criterion = VICReg()
optimizer = torch.optim.Adam(model.parameters(), lr = 0.0005)

pretext_train(model, 50, trainloader, valloader, criterion, optimizer, state = None, name = "single_vr")